<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jobseeker Dashboard</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.0/font/bootstrap-icons.css">
    <!-- Custom Dashboard CSS -->
    <link rel="stylesheet" href="../css/jobseekers-dashboard.css">
</head>

<body>
    <div class="container-fluid">
        <div class="row">
            <!-- Sidebar Column -->
            <!-- <div class="col-md-3 col-lg-2 d-md-block bg-light sidebar"> -->
            <div id="sidebar" class="sidebar-container"></div>
            <!-- </div> -->

            <!-- Main Content Column -->
            <div class="col-md-9 col-lg-10 ms-sm-auto px-md-4 py-4">
                <header class="mb-4">
                    <h1 class="fw-bold">Job Search Dashboard</h1>
                    <p class="text-muted">Track your job search progress and stay organized</p>
                </header>

                <!-- Stats Cards -->
                <div class="row mb-4">
                    <div class="col-md-3 mb-3">
                        <div class="card h-100">
                            <div class="card-body d-flex justify-content-between align-items-center">
                                <div>
                                    <p class="text-muted small mb-1">Total Applications</p>
                                    <h3 class="fw-bold" id="total-applications">4</h3>
                                </div>
                                <i class="bi bi-briefcase text-primary fs-4"></i>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3 mb-3">
                        <div class="card h-100">
                            <div class="card-body d-flex justify-content-between align-items-center">
                                <div>
                                    <p class="text-muted small mb-1">Interviews</p>
                                    <h3 class="fw-bold" id="total-interviews">1</h3>
                                </div>
                                <i class="bi bi-calendar-event text-warning fs-4"></i>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3 mb-3">
                        <div class="card h-100">
                            <div class="card-body d-flex justify-content-between align-items-center">
                                <div>
                                    <p class="text-muted small mb-1">Offers</p>
                                    <h3 class="fw-bold" id="total-offers">1</h3>
                                </div>
                                <i class="bi bi-check-circle text-success fs-4"></i>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3 mb-3">
                        <div class="card h-100">
                            <div class="card-body d-flex justify-content-between align-items-center">
                                <div>
                                    <p class="text-muted small mb-1">Response Rate</p>
                                    <h3 class="fw-bold" id="response-rate">50%</h3>
                                </div>
                                <i class="bi bi-bullseye text-purple fs-4"></i>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tabs Navigation -->
                <ul class="nav nav-tabs mb-4" id="dashboardTabs" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active" id="applications-tab" data-bs-toggle="tab"
                            data-bs-target="#applications" type="button" role="tab">Applications</button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="skills-tab" data-bs-toggle="tab" data-bs-target="#skills"
                            type="button" role="tab">Skills Assessment</button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="documents-tab" data-bs-toggle="tab" data-bs-target="#documents"
                            type="button" role="tab">Documents</button>
                    </li>
                    <!-- <li class="nav-item" role="presentation">
                        <button class="nav-link" id="goals-tab" data-bs-toggle="tab" data-bs-target="#goals" type="button"
                            role="tab">Goals</button>
                    </li> -->
                </ul>

                <!-- Tab Content -->
                <div class="tab-content" id="dashboardTabsContent">
                    <!-- Applications Tab -->
                    <div class="tab-pane fade show active" id="applications" role="tabpanel"
                        aria-labelledby="applications-tab">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="card-title mb-0">Application Tracker</h5>
                                <p class="card-text text-muted small">Track the status of your job applications</p>

                                <!-- Status Legend -->
                                <div class="d-flex gap-2 my-2">
                                    <div class="flex-grow-1 rounded" style="height: 8px; background-color: #0d6efd;">
                                    </div>
                                    <div class="flex-grow-1 rounded" style="height: 8px; background-color: #ffc107;">
                                    </div>
                                    <div class="flex-grow-1 rounded" style="height: 8px; background-color: #dc3545;">
                                    </div>
                                    <div class="flex-grow-1 rounded" style="height: 8px; background-color: #198754;">
                                    </div>
                                    <!-- <div class="flex-grow-1 rounded" style="height: 8px; background-color: #e9ecef;"></div> -->
                                </div>

                                <div class="d-flex justify-content-between text-sm mb-2">
                                    <span class="text-primary">Applied (<span id="applied-count">1</span>)</span>
                                    <span class="text-warning">Interview (<span id="interview-count">1</span>)</span>
                                    <span class="text-danger">Rejected (<span id="rejected-count">1</span>)</span>
                                    <span class="text-success">Offer (<span id="offer-count">1</span>)</span>
                                    <span>&nbsp;</span>
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-hover">
                                        <thead>
                                            <tr>
                                                <th>Company</th>
                                                <th>Position</th>
                                                <th>Status</th>
                                                <th>Date</th>
                                                <th>Notes</th>
                                            </tr>
                                        </thead>
                                        <tbody id="applications-table-body">
                                            <!-- Application rows will be inserted here by JavaScript -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Skills Assessment Tab -->
                    <div class="tab-pane fade" id="skills" role="tabpanel" aria-labelledby="skills-tab">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="card-title mb-0">Skills Assessment</h5>
                                <p class="card-text text-muted small">Track your skill proficiency levels</p>
                            </div>
                            <div class="card-body">
                                <div id="skills-container">
                                    <!-- Skills will be inserted here by JavaScript -->
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Documents Tab -->
                    <div class="tab-pane fade" id="documents" role="tabpanel" aria-labelledby="documents-tab">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="card-title mb-0">Document Management</h5>
                                <p class="card-text text-muted small">Manage your resumes, cover letters and other
                                    documents</p>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-hover">
                                        <thead>
                                            <tr>
                                                <th>Document</th>
                                                <th>Version</th>
                                                <th>Last Updated</th>
                                            </tr>
                                        </thead>
                                        <tbody id="documents-table-body">
                                            <!-- Document rows will be inserted here by JavaScript -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Goals Tab
                    <div class="tab-pane fade" id="goals" role="tabpanel" aria-labelledby="goals-tab">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="card-title mb-0">Goals & Progress</h5>
                                <p class="card-text text-muted small">Track your job search goals and progress</p>
                            </div>
                            <div class="card-body">
                                <div id="goals-container">
                                    Goals will be inserted here by JavaScript -->
                    <!-- </div> -->
                    <!-- </div> -->
                    <!-- </div> -->
                    <!-- </div> -->
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script src="../js/jobseeker-dashboard.js"></script>

    <!-- Custom JavaScript for Dashboard -->
    <script>
        // Sample data - in a real app, this would come from a backend
        const applications = [
            { id: 1, company: "Tech Solutions Inc.", position: "Frontend Developer", status: "Applied", date: "2025-03-01", notes: "Applied through company website" },
            { id: 2, company: "Digital Innovations", position: "React Developer", status: "Interview", date: "2025-02-25", notes: "First interview scheduled for March 15" },
            { id: 3, company: "Software Corp", position: "UI Engineer", status: "Rejected", date: "2025-02-10", notes: "Position was filled internally" },
            { id: 4, company: "Web Systems", position: "Full Stack Developer", status: "Offer", date: "2025-03-05", notes: "Need to respond by March 20" }
        ];

        const skills = [
            { id: 1, name: "React", proficiency: 85 },
            { id: 2, name: "JavaScript", proficiency: 90 },
            { id: 3, name: "CSS", proficiency: 75 },
            { id: 4, name: "Node.js", proficiency: 60 },
            { id: 5, name: "TypeScript", proficiency: 70 }
        ];

        const documents = [

        ];

        // Function to get status color class
        function getStatusColorClass(status) {
            switch (status) {
                case "Applied": return "text-primary";
                case "Interview": return "text-warning";
                case "Rejected": return "text-danger";
                case "Offer": return "text-success";
                default: return "text-muted";
            }
        }

        // Function to calculate application statistics
        function calculateStats() {
            const stats = {
                total: applications.length,
                applied: applications.filter(app => app.status === "Applied").length,
                interview: applications.filter(app => app.status === "Interview").length,
                rejected: applications.filter(app => app.status === "Rejected").length,
                offer: applications.filter(app => app.status === "Offer").length
            };

            // Update stats in the UI
            document.getElementById('total-applications').textContent = stats.total;
            document.getElementById('total-interviews').textContent = stats.interview;
            document.getElementById('total-offers').textContent = stats.offer;
            document.getElementById('applied-count').textContent = stats.applied;
            document.getElementById('interview-count').textContent = stats.interview;
            document.getElementById('rejected-count').textContent = stats.rejected;
            document.getElementById('offer-count').textContent = stats.offer;

            // Calculate response rate (interviews + offers / total)
            const responseRate = stats.total > 0
                ? Math.round(((stats.interview + stats.offer) / stats.total) * 100)
                : 0;
            document.getElementById('response-rate').textContent = `${responseRate}%`;
        }

        // Populate applications table
        function populateApplications() {
            const tableBody = document.getElementById('applications-table-body');
            tableBody.innerHTML = '';

            applications.forEach(app => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${app.company}</td>
                    <td>${app.position}</td>
                    <td class="${getStatusColorClass(app.status)}">${app.status}</td>
                    <td>${app.date}</td>
                    <td>${app.notes}</td>
                `;
                tableBody.appendChild(row);
            });
        }

        // Populate skills section
        function populateSkills() {
            const skillsContainer = document.getElementById('skills-container');
            skillsContainer.innerHTML = '';

            skills.forEach(skill => {
                const skillDiv = document.createElement('div');
                skillDiv.className = 'mb-4';
                skillDiv.innerHTML = `
                    <div class="d-flex justify-content-between mb-1">
                        <span>${skill.name}</span>
                        <span class="text-muted">${skill.proficiency}%</span>
                    </div>
                    <div class="progress" style="height: 10px;">
                        <div class="progress-bar" role="progressbar" style="width: ${skill.proficiency}%;" 
                            aria-valuenow="${skill.proficiency}" aria-valuemin="0" aria-valuemax="100"></div>
                    </div>
                `;
                skillsContainer.appendChild(skillDiv);
            });
        }

        // Populate documents table
        // Modify the populateDocuments function to include the user's resume if available
        function populateDocuments() {
            const tableBody = document.getElementById('documents-table-body');
            tableBody.innerHTML = '';

            // Get user data from localStorage
            const user = JSON.parse(localStorage.getItem("user"));

            // First, add any existing documents from our documents array
            documents.forEach(doc => {
                const row = document.createElement('tr');
                row.innerHTML = `
            <td><i class="bi bi-file-earmark-text me-2"></i>${doc.name}</td>
            <td>${doc.version}</td>
            <td>${doc.lastUpdated}</td>
        `;
                tableBody.appendChild(row);
            });

            // Then, check if user has a resume_url and add it to the table
            if (user && user.resume_url) {
                const today = new Date().toISOString().slice(0, 10); // Format: YYYY-MM-DD

                const row = document.createElement('tr');
                row.innerHTML = `
            <td><i class="bi bi-file-earmark-pdf me-2"></i><a href="${user.resume_url}" target="_blank">My Resume</a></td>
            <td>Current</td>
            <td>${today}</td>
        `;
                tableBody.appendChild(row);
            }
        }

       
        // Initialize the dashboard
        document.addEventListener('DOMContentLoaded', function () {
            calculateStats();
            populateApplications();
            populateSkills();
            populateDocuments();
        });
    </script>
</body>

</html>